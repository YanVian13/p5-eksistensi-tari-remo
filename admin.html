<!doctype html>
<html>
<head><meta charset="utf-8"><title>Admin - Remo</title></head>
<body>
  <h2>Admin - Pending uploads</h2>
  <input id="token" placeholder="Admin token">
  <button id="load">Load pending</button>
  <div id="list"></div>

<script>
document.getElementById('load').onclick = async () => {
  const token = document.getElementById('token').value.trim();
  if(!token) return alert('Masukkan token');
  const res = await fetch('/api/admin', { headers: { 'x-admin-token': token }});
  const j = await res.json();
  if(!j.ok) { alert('Error: ' + (j.error || '')); return; }
  const list = document.getElementById('list');
  list.innerHTML = '';
  j.resources.forEach(r => {
    const div = document.createElement('div');
    div.innerHTML = `<img src="${r.secure_url}" style="width:160px"><div>${r.public_id}</div>
      <button onclick="act('${r.public_id}','approve')">Approve</button>
      <button onclick="act('${r.public_id}','reject')">Reject</button>`;
    list.appendChild(div);
  });
  window.act = async (id,act) => {
    const res2 = await fetch('/api/admin', {
      method:'POST', headers:{ 'Content-Type':'application/json', 'x-admin-token': token},
      body: JSON.stringify({ action: act, public_id: id })
    });
    const j2 = await res2.json();
    alert(JSON.stringify(j2));
    document.getElementById('load').click();
  };
};
</script>
</body>
</html>
